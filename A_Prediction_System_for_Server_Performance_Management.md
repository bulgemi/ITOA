서버 성능 관리를 위한 장애 예측 시스템
===================================
출처
----
* 한국정보전자통신기술학회 논문지 11(6), 2018.12, 684-690

서론
----
> 빅데이터의 확성화를 위하여 대량의 데이터를 수집/분석할 수 있는 하드웨어, 데이터 플랫폼,
> 분석기술(자연처리, 의미분석, 데이터 마이닝)과 같은 소프트웨어의 개발이 필수다.
> 서버 성능 관리를 위하여 서버의 성능에 영향을 미치는 성능 지표를 정의.
> 지표를 모니터링 할 수 있는 시스템을 설계하고 구현.
> 서버 성능 모니터링 데이터는 시간의 흐름과 일정한 시간을 두고 축적이 되며,
> 시간의 흐름에 따라 변하는 현상을 관찰함으로써 얻어지는 일련의 자료들이며,
> 이와 같은 데이터를 시계열 데이터라 함.
> 서버 중에 예측을 위하여 성능 지표 기반의 모니터링 데이터를 빅데이터라 가정하고
> 빅데이터 수집/분석 기술(데이터 마이닝-시계열 예측)을 활용한 시스템을 제안.

관련연구
-------
> 빅데이터는 빅 트랜잭션 데이터와 상호 작용 데이터 및 빅데이터 처리로 구성된 세 부분이 융합된 것으로,
> 트랜젝션과 상호작용 데이터를 모두 포함해서 작절한 비용과 시간, 일반적으로 사용되는 기술을 사용하여
> 파악 및 관리하기에는 너무 방대하고 복잡한 데이터를 의미하는 것

* 성능 지표

성능지표  |  정의  |  단위(예)  |  목표
--  |  --  |  --  |  --
응답시간(Response Time)  |  작업 처리를 요청한 시간으로부터 이를 시스템이 처리하여 결과를 보여줄 때까지 소요된 시간  |  초  |  낮춤
시간당 처리량(Throughput)  |  시스템이 성공적으로 처리한 단위 시간당 요청(트랜잭션) 처리 건수  |  TPS, OPS  |  높임
자원 사용량(Utilization)  |  자원(CPU, 메모리 등)들의 용량 중 실제 사용하고 있는 값의 비율  |  %  |  높임
효율성(Efficiency)  |  시간당 처리량을 자원사용량 또는 비용으로 나눈 값  |  %, tpmC  |  높임

  - TPS: Transactions Per Seconds, 초당 트랜잭션 처리건수
  - OPS: Operations Per Seconds, 초당 요청 처리건수
  - tpmC: transctions per minute per Cost, 단위 비용당 분당 처리건수

> 시계열 예측(Time Series Prediction)은 주어진 시계열을 보고 수학적인 모델을
> 만들어서 미래에 일어날 것들을 예측하는 것

모니터링 지표와 예측 모형
-----------------------
1. 모니터링 지표 분류
  - 모니터링 지표(2차)

분야  |  감시항목  |  항목개수
--  |  --  |  --
CPU  |  CPU Min, Max, Average 사용량 |  3
Memory  |  Memory Min, Max, Average 사용량 |  3
디스크  |  Device별 Disk Min, Max, Average 사용량 |  3
프로세스  |  Instance별 CPU(Min, Max) 사용량, Memory(Min, Max) 사용량, Process down, Operating System 감시 |  6
네트워크  |  Instance별 Send, Send error, Receive, Receive error, Collision, Ping 여부, Channel down, Node down, 서비스 포트  |  9
응용 프로그램  |  Service별 시도호, 성공호, 성공률, 성공 및 오류 코드 횟수, 평균 응답 시간, 응답 시간별 성공호의 수, Service별 동시 접속 Users, 서비스 Daemon down, Agent 감시, 사용자 세션 |  11

2. 모니터링 지표에 대한 가설 및 검증
  - 모니터링 지표(최종)

분야  |  가설 요약  |  유효항목
--  |  --  |  --
CPU, Memory, Disk 등  |  1.Peak 시간 CPU 사용율, 2.Peak 시간 Memory 사용율, 3.전체 Disk 사용율  |  가설 1
Process, Queue 등  |  4.특정 Proecess가 CPU 사용율, 5.특정 Process가 차지하는 메모리 사용율, 6.Process의 개수, 7.특정 Process의 Thread 개수  |  가설 4, 가설 5, 가설 7
네트워크, Node 등  |  8.해당 서버나 네트워크 장비에 Ping 응답 시간, 9.해당 서버나 네크워크 장비에 호출된 요청/응답의 패킷  |  가설 9
Web, WAS 등  |  11.Web, WAS에서 발생되는 로그에서 응답시간, 12.Web, WAS에서 발생되는 로그에서 서비스 응답 실패율  |  제외

  - 지표별 임계치

모니터링 지표  |  임계치  |  비고
--  |  --  |  --
Peak시간 CPU 사용율  |  Max 55% 이상, Avg 30% 이상  |  허용치 범위 +- 5%
특정 Process의 CPU 사용율  |  지정값 이하  |  실제 A 운영, 서비스: 10%
개별 Process 메모리  |  지정값 이하  |  실제 A 운영, 서비스: 65%
특정 Process의 Thread  |  Max 30% 이상, Min 13% 이상 |  실제 A 운영, 서비스: 평균 160개(6개월)
요청/응답 패킷 사용율  |  평상시보다 50% 이상 |  허용치 범위 +- 5%

서버 장애 예측 시스템
--------------------
1. 구축환경
> 서버 장애 모니터링을 위하여 오픈 소스 Ganglia와 수집 데이터의 실시간 전송을 위한 Esper를 작용.
> 분석을 위한 빅데이터 분석 플랫폼 Hadoop 기반으로 구성.
* 모니터링 데이터를 수집하기 위하여 오픈 소스인 Ganglia 3.6.X<http://ganglia.sourceforge.net/>
* HDFS(Hadoop Distribution File System)
* 개발 플랫폼 구성: hadoop 2.2.X, hive 0.12.X, pig 0.1.2.X
* 빅데이터 분석과 시각화: SAS 9.1.2
* 빅데이터 처리 분석 기술: 맵리듀스

서버 장애 예측 모형 분석 및 검증
------------------------------
> 빅데이터 환경을 고려한 서버 성능 모니터링 환경에서 감시되는 모니터링 지표별 데이터는 자동화되어
> 로그로 쌓인다. 이를 Ganglia에서 제공하는 Web-frontend 화면에서 CSV 파일로 추출하였고,
> 상용 솔루션 SPSS의 검증 결과로 검증.
> 시계열 모형으로는 Winters가법 모형이 가장 적합한 모형으로 분석.
> Winters가법 모형은 선형 추세와 계절 효과가 계열 수준에 따르지 않는 계열에 적합.
