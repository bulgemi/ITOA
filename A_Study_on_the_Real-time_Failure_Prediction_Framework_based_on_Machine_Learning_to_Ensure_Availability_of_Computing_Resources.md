컴퓨팅 자원의 가용성을 보장하기 위한 기계 학습 기반의 실시간 장애 예측 프레임워크 연구
===============================================================================
출처
----
* 전자공학회논문지 56(4), 2019.4, 63-76

서론
----
* 온라인 장애 예측: 복잡한 컴퓨터 시스템에서 미래의 장애를 예측하여 사전 대처 가능
* 기계 학습 기반의 예측 모델: 특징 추출, 특징 공학을 통한 데이터 변형 후 분류기 적용, 정확한 예측을 위한 장애와 관련 높은 데이터 수집 및 적절한 알고리즘 조합
* 자동화 프레임워크
    * 예측에 접합한 데이터
    * 예측 알고리즘
    * 모델 파라미터 최적화

배경 개념
--------------
* 시스템 장애 예측
> 장애 예측은 방식에 따라 Online Failure Prediction, Prediction of System Reliability, Proactive Failure Detection, Early Damage Detection, Anomaly Detection 등과 같은 용어로 불린다.
> Online Failure Prediction을 일반적으로 시스템 장애 예측이라 함.(모니터링 된 현재의 시스템 상태에 기반하여 가까운 미래의 장애 발생 여부를 런타임 중에 예측)
> 최초에 장애의 근본 원인(Fault)이 될 수 있는 부분이 발생하고, 이 부분이 실제 실행되면 시스템이 정상 상태에서 벗어나는 에러(Error) 이벤트가 생긴다.
> 이 때 시스템은 여러 시스템 상태 지표를 통해 시스템이 정상 상태에서 벗어났음을 증상(Symptom) 이벤트로 보여준다.
> 또한 에러가 누적되어 실제 서비스나 시스템에 비정상적인 상태를 유발한 것이 장애(Failure) 이벤트가 된다.
> 복잡한 시스템에서 장애는 크게 Byzantine, Authentification detectable byzantine, Performance, Omission, Crash, Fail-stop 6가지로 구분될 수 있다.
> Byzantine: 통제되지 않은 비정상적인 모든 경우의 장애.
> Authentification detectable byzantine: 통제되지 않은 비정상적인 모든 경우의 장애 중 시스템 메시지가 위조되지 않은 경우.
> Performance: 응답 결과가 빠르거나 늦는 경우의 장애, Omission: 응답 결과가 일부 생략되는 장애, Crash: 모든 요청에 응답이 없는 경우의 장애,
> Fail-Stop: Crash 장애와 동시에, 해당 시스템이 멈추었는지 식별 가능한 경우의 장애.
> 예측은 과거의 데이터 분석을 기반으로 예측 모델을 생성하여 수행. 예측 모델을 생성하기 위해서 통계적 기법, 패턴 인식, 기계 학습 사용.
> 발생하는 장애를 놓치지 않고 예측하는 것이 중요. 잘못 예측하는 경우가 없어야 한다.

* 시스템 모니터링
> 장애 예측을 위해서는 예측 시스템의 상태 데이터가 수집 필요.(메트릭과 로그의 형태로 수집) 메트릭은 주기적으로 측정(시스템 및 서비스의 상태, 성능, 자원의 상태 값),
> 로그는 시스템 및 서비스에서 발생한 이벤트 또는 현재 상태를 메시지 형식으로 표현. 일반적으로 syslog 활용.
> 대표적인 메트릭 수집 시스템으로 SMART(Self-Monitoring, Analysis and Reporting Technology) 있음.
> 모니터링 시스템은 필요 데이터 선별 및 수집, 관리 기능 제공.

* 장애 예측 모델 생성 최적화 과정
> 데이터 준비, 예측 알고리즘 선택, 특징 공학, 모델 생성 및 최적화, 모델 평가 및 선택, 모델 배포 및 적용, 필요시 모델 분석 및 업데이트의 7단계.

관련 연구
-----------
* 시스템 별 장애 예측
> HDD 장애 예측: 앙상블 트리 기법 or 신경망 적용, SMART 데이터와 시스템 로그 사용, 서버 장애 예측은 서버 모니터링 시스템에서 수집된 메트릭 데이터 활용.
> 동적 시스템: 시스템 구조나 플랫폼의 버전이 업데이트 되는 경우를 뜻함. 장애 예측을 위해 동적으로 바뀌는 특성이 예측 모델에 반영되어야 함.
> 두 가지 방식의 접근 필요.
> 첫째, 시스템 구조 동적 변경시 시스템 컴포넌트를 동적으로 추적하여 컴포넌트들의 상관관계를 기반으로 예측 모델 생성.
> 둘째, 플랫폼 버전이 동적으로 업데이트 되는 경우로 실시간으로 업데이트하여 변경된 플랫폼에 맞게 예측을 수행.
> 변경된 시스템에서 수집되는 데이터를 예측 모델에 재학습 or 처음부터 다시 학습.

* 장애 데이터 생성
> 장애 예측에서 중요한 문제. 정확한 예측을 위해 실제 장애 데이터가 많아야 함. 유사 환경을 구성하여 결점 주입을 통한 장애 데이터 수집.

장애 예측 프레임워크 설계
-------------------------
* 프레임워크 구조 및 동작
![프레임워크 전체 구조](https://github.com/bulgemi/ITOA/blob/master/프레임워크_전체_구조.PNG)
> 데이터 준비(Data Preparation), 모델 최적화 및 선택(Model Optimization & Selection), 예측(Prediction) 모듈로 구성.

![프레임워크 동작 과정](https://github.com/bulgemi/ITOA/blob/master/프레임워크_동작_과정.PNG)
> 프레임워크는 시스템 자원을 모니터링하여 장애 및 정상 상태에서의 시스템 데이터 주기적 수집.
> 수집된 데이터들은 전처리하여 최적화된 후 예측 모델 생성, 실시간 수집 데이터는 예측에 사용.

* 데이터 준비 모듈
  - 모니터링 에이전트: 서버 및 HDD의 상태정보를 주기적 수집. 수집된 데이터는 메시지 큐를 통해 데이터베이스에 저장 or 온라인 장애 예측에 활용.
  - 장애 탐지기: 발생하는 장애 탐지 및 저장. 기존 모델을 개선하거나 향후 새로운 모델 생성에 활용.
  - 데이터 탐색기: 사용자가 수집되는 데이터 확인, 데이터 분포 및 상관관계 등의 기본적인 분석 기능 제공.

> 데이터 수집 모듈은 확장성을 고려한 Monasca로 구현. 대용량 분산 메시징 시스템은 Kafka, 데이터 저장은 InfluxDB 활용.

* 모델 최적화 및 선택 모듈
  - 설정 해석기(Configuration Interpreter): 제출된 모델 정보를 파싱하여 최적화기에 전달.
  - 최적화기(Optimizer): 알고리즘을 적용한 모델 생성, 특징 선택, 모델 최적화 및 선택을 수행.
    - 모델 생성, 특징 선택, 학습, 튜닝, 평가 및 선택.
      ![예측 모델 최적화 과정](https://github.com/bulgemi/ITOA/blob/master/예측_모델_최적화_과정.PNG)
      > 수집된 데이터는 훈련 데이터, 검증 데이터, 테스트 데이터로 구분.


![사용자가 제출하는 모델 설정값](https://github.com/bulgemi/ITOA/blob/master/사용자가_제출하는_모델_설정_값.PNG)
> '예측 대상 장애와 예측 모델 설정'을 프레임워크에 제출, 프레임워크는 예측하려는 값에 대응하는 데이터와 설정을 최적화기에 보냄.
> 최적화기에서 특징(입력) 값, 모델 파라미터, 하이퍼파라미터를 최적화하고 가장 성능이 좋은 모델을 선택, 업데이터 한다.
> 예측기에서는 업데이트된 모델과 모니터링 시스템을 통해 실시간 데이터를 이용하여 장애 예측 수행.
